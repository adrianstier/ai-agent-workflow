<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AgentFlow — AI Workflow System</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    :root {
      --bg-base: #f8fafc;
      --bg-surface: #ffffff;
      --bg-elevated: #f1f5f9;

      --text-primary: #0f172a;
      --text-secondary: #475569;
      --text-muted: #94a3b8;

      --border: #e2e8f0;
      --border-strong: #cbd5e1;

      --core: #3b82f6;
      --core-light: #dbeafe;
      --core-dark: #1d4ed8;
      --core-glow: rgba(59, 130, 246, 0.3);

      --debug: #f97316;
      --debug-light: #ffedd5;
      --debug-dark: #c2410c;
      --debug-glow: rgba(249, 115, 22, 0.3);

      --review: #22c55e;
      --review-light: #dcfce7;
      --review-dark: #15803d;
      --review-glow: rgba(34, 197, 94, 0.3);

      --accent: #8b5cf6;
      --highlight: #fbbf24;

      --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-base);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.5;
    }

    /* Layout */
    .app {
      display: grid;
      grid-template-columns: 1fr 420px;
      grid-template-rows: 72px 1fr;
      min-height: 100vh;
    }

    /* Header */
    .header {
      grid-column: 1 / -1;
      background: var(--bg-surface);
      border-bottom: 1px solid var(--border);
      padding: 0 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brand-icon {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, var(--core), var(--accent));
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .brand-icon svg {
      width: 24px;
      height: 24px;
      color: white;
    }

    .brand-text h1 {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: -0.5px;
    }

    .brand-text span {
      font-size: 13px;
      color: var(--text-muted);
    }

    .header-stats {
      display: flex;
      gap: 40px;
    }

    .stat {
      text-align: center;
    }

    .stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .stat-label {
      font-size: 12px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Main visualization */
    .main {
      position: relative;
      overflow: hidden;
      background: var(--bg-base);
    }

    #visualization {
      width: 100%;
      height: 100%;
    }

    /* Category Labels in viz - now visible */
    .category-badge {
      position: absolute;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 6px 14px;
      border-radius: 20px;
      pointer-events: none;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .category-badge::before {
      content: '';
      width: 8px;
      height: 8px;
      border-radius: 50%;
    }

    .category-badge.core {
      background: var(--core-light);
      color: var(--core-dark);
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
    }
    .category-badge.core::before { background: var(--core); }

    .category-badge.debug {
      background: var(--debug-light);
      color: var(--debug-dark);
      top: 20px;
      left: 20px;
    }
    .category-badge.debug::before { background: var(--debug); }

    .category-badge.review {
      background: var(--review-light);
      color: var(--review-dark);
      top: 20px;
      right: 20px;
    }
    .category-badge.review::before { background: var(--review); }

    /* Controls */
    .controls {
      position: absolute;
      bottom: 24px;
      left: 24px;
      display: flex;
      gap: 8px;
    }

    .btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 16px;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      font-family: inherit;
      font-size: 14px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.15s ease;
      box-shadow: var(--shadow-sm);
    }

    .btn:hover {
      background: var(--bg-elevated);
      border-color: var(--border-strong);
      color: var(--text-primary);
    }

    .btn:focus {
      outline: none;
      box-shadow: 0 0 0 3px var(--core-glow);
    }

    .btn.active {
      background: var(--core);
      border-color: var(--core);
      color: white;
    }

    .btn svg {
      width: 16px;
      height: 16px;
    }

    /* Sidebar */
    .sidebar {
      background: var(--bg-surface);
      border-left: 1px solid var(--border);
      display: flex;
      flex-direction: column;
    }

    .sidebar-tabs {
      display: flex;
      border-bottom: 1px solid var(--border);
    }

    .tab {
      flex: 1;
      padding: 16px;
      background: none;
      border: none;
      font-family: inherit;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.15s ease;
      border-bottom: 2px solid transparent;
      margin-bottom: -1px;
    }

    .tab:hover {
      color: var(--text-secondary);
    }

    .tab:focus {
      outline: none;
      background: var(--bg-elevated);
    }

    .tab.active {
      color: var(--core);
      border-bottom-color: var(--core);
    }

    .sidebar-content {
      flex: 1;
      overflow-y: auto;
      padding: 24px;
    }

    /* Panel states */
    .panel {
      display: none;
    }

    .panel.active {
      display: block;
      animation: fadeIn 0.2s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Onboarding welcome */
    .welcome {
      text-align: center;
      padding: 20px 0;
    }

    .welcome-icon {
      width: 72px;
      height: 72px;
      background: linear-gradient(135deg, var(--core-light), var(--review-light));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
    }

    .welcome-icon svg {
      width: 36px;
      height: 36px;
      color: var(--core);
    }

    .welcome h3 {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .welcome p {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 24px;
      max-width: 320px;
      margin-left: auto;
      margin-right: auto;
    }

    .quick-actions {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .quick-action {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 10px;
      text-align: left;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .quick-action:hover {
      background: var(--bg-surface);
      border-color: var(--core);
      box-shadow: var(--shadow-md);
    }

    .quick-action:focus {
      outline: none;
      box-shadow: 0 0 0 3px var(--core-glow);
    }

    .quick-action-icon {
      width: 36px;
      height: 36px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .quick-action-icon.blue {
      background: var(--core-light);
      color: var(--core);
    }

    .quick-action-icon.orange {
      background: var(--debug-light);
      color: var(--debug);
    }

    .quick-action-icon.green {
      background: var(--review-light);
      color: var(--review);
    }

    .quick-action-icon svg {
      width: 18px;
      height: 18px;
    }

    .quick-action-text strong {
      display: block;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .quick-action-text span {
      font-size: 12px;
      color: var(--text-muted);
    }

    /* Agent detail panel */
    .agent-header {
      display: flex;
      align-items: flex-start;
      gap: 16px;
      margin-bottom: 24px;
      padding-bottom: 24px;
      border-bottom: 1px solid var(--border);
    }

    .agent-badge {
      width: 56px;
      height: 56px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 700;
      flex-shrink: 0;
    }

    .agent-badge.core {
      background: var(--core-light);
      color: var(--core);
    }

    .agent-badge.debug {
      background: var(--debug-light);
      color: var(--debug);
    }

    .agent-badge.review {
      background: var(--review-light);
      color: var(--review);
    }

    .agent-info h2 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .agent-tag {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 4px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .agent-tag::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
    }

    .agent-tag.core {
      background: var(--core-light);
      color: var(--core-dark);
    }
    .agent-tag.core::before { background: var(--core); }

    .agent-tag.debug {
      background: var(--debug-light);
      color: var(--debug-dark);
    }
    .agent-tag.debug::before { background: var(--debug); }

    .agent-tag.review {
      background: var(--review-light);
      color: var(--review-dark);
    }
    .agent-tag.review::before { background: var(--review); }

    .section {
      margin-bottom: 24px;
    }

    .section-title {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--text-muted);
      margin-bottom: 12px;
    }

    .section p {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .use-case-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .use-case {
      padding: 12px 14px;
      background: var(--bg-elevated);
      border-radius: 8px;
      font-size: 14px;
      color: var(--text-secondary);
      border-left: 3px solid var(--core);
    }

    .use-case.debug { border-left-color: var(--debug); }
    .use-case.review { border-left-color: var(--review); }

    .output-code {
      display: inline-block;
      padding: 8px 12px;
      background: var(--bg-elevated);
      border-radius: 6px;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 13px;
      color: var(--text-secondary);
    }

    /* Navigation hint */
    .nav-hint {
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid var(--border);
      display: flex;
      gap: 8px;
    }

    .nav-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      padding: 10px;
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 8px;
      font-family: inherit;
      font-size: 13px;
      font-weight: 500;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .nav-btn:hover {
      background: var(--bg-surface);
      border-color: var(--core);
      color: var(--core);
    }

    .nav-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .nav-btn svg {
      width: 14px;
      height: 14px;
    }

    /* Legend panel */
    .legend-section {
      margin-bottom: 28px;
    }

    .legend-title {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .legend-dot.core { background: var(--core); }
    .legend-dot.debug { background: var(--debug); }
    .legend-dot.review { background: var(--review); }

    .legend-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 10px 12px;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.15s ease;
      border: 1px solid transparent;
    }

    .legend-item:hover {
      background: var(--bg-elevated);
    }

    .legend-item:focus {
      outline: none;
      border-color: var(--core);
      box-shadow: 0 0 0 2px var(--core-glow);
    }

    .legend-item.selected {
      background: var(--core-light);
      border-color: var(--core);
    }

    .legend-num {
      width: 28px;
      height: 28px;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      font-weight: 600;
    }

    .legend-num.core {
      background: var(--core-light);
      color: var(--core);
    }

    .legend-num.debug {
      background: var(--debug-light);
      color: var(--debug);
    }

    .legend-num.review {
      background: var(--review-light);
      color: var(--review);
    }

    .legend-name {
      font-size: 14px;
      font-weight: 500;
    }

    /* Get started panel */
    .step {
      margin-bottom: 20px;
      padding: 20px;
      background: var(--bg-elevated);
      border-radius: 12px;
    }

    .step-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
    }

    .step-num {
      width: 28px;
      height: 28px;
      background: var(--core);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 600;
    }

    .step h3 {
      font-size: 15px;
      font-weight: 600;
    }

    .step p {
      font-size: 14px;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }

    .code-block {
      position: relative;
      background: #1e293b;
      border-radius: 8px;
      padding: 16px;
      font-family: 'IBM Plex Mono', monospace;
      font-size: 13px;
      line-height: 1.5;
      color: #e2e8f0;
      overflow-x: auto;
    }

    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      padding: 4px 10px;
      background: rgba(255,255,255,0.1);
      border: none;
      border-radius: 4px;
      color: #94a3b8;
      font-family: inherit;
      font-size: 11px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .copy-btn:hover {
      background: rgba(255,255,255,0.15);
      color: white;
    }

    /* SVG node styles */
    .node-group { cursor: pointer; }

    .node-bg {
      transition: all 0.2s ease;
    }

    .node-group:hover .node-bg {
      transform: scale(1.1);
      filter: drop-shadow(0 4px 12px currentColor);
    }

    .node-group.selected .node-bg {
      stroke: var(--highlight);
      stroke-width: 3;
    }

    .node-label {
      font-family: 'DM Sans', sans-serif;
      font-weight: 600;
      fill: white;
      text-anchor: middle;
      dominant-baseline: central;
      pointer-events: none;
    }

    .node-name {
      font-family: 'DM Sans', sans-serif;
      font-size: 11px;
      font-weight: 500;
      fill: var(--text-primary);
      text-anchor: middle;
      pointer-events: none;
    }

    .link-line {
      fill: none;
      stroke: var(--border-strong);
      stroke-width: 2;
      opacity: 0.4;
    }

    .link-flow {
      fill: none;
      stroke-width: 4;
      stroke-linecap: round;
      stroke-dasharray: 8 6;
      opacity: 0;
    }

    /* Flow animation path */
    .workflow-path {
      fill: none;
      stroke: var(--core);
      stroke-width: 3;
      stroke-linecap: round;
      opacity: 0;
    }

    .workflow-path.active {
      opacity: 0.6;
      stroke-dasharray: 1000;
      stroke-dashoffset: 1000;
      animation: flowDash 3s ease forwards;
    }

    @keyframes flowDash {
      to { stroke-dashoffset: 0; }
    }

    /* Progress indicator */
    .progress-indicator {
      position: absolute;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 16px;
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 20px;
      box-shadow: var(--shadow-md);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .progress-indicator.visible {
      opacity: 1;
    }

    .progress-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--border);
      transition: all 0.2s ease;
    }

    .progress-dot.active {
      background: var(--core);
      transform: scale(1.25);
    }

    .progress-dot.done {
      background: var(--core);
    }

    .progress-label {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-secondary);
      margin-left: 8px;
    }

    /* Responsive */
    @media (max-width: 1100px) {
      .app {
        grid-template-columns: 1fr 360px;
      }

      .header-stats {
        gap: 24px;
      }
    }

    @media (max-width: 900px) {
      .app {
        grid-template-columns: 1fr;
        grid-template-rows: 72px 1fr auto;
      }

      .sidebar {
        border-left: none;
        border-top: 1px solid var(--border);
        max-height: 50vh;
      }

      .header-stats {
        display: none;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header class="header">
      <div class="brand">
        <div class="brand-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"/>
            <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/>
          </svg>
        </div>
        <div class="brand-text">
          <h1>AgentFlow</h1>
          <span>AI Workflow System</span>
        </div>
      </div>
      <div class="header-stats">
        <div class="stat">
          <div class="stat-value">21</div>
          <div class="stat-label">Agents</div>
        </div>
        <div class="stat">
          <div class="stat-value">91%</div>
          <div class="stat-label">Test Score</div>
        </div>
        <div class="stat">
          <div class="stat-value">3</div>
          <div class="stat-label">Categories</div>
        </div>
      </div>
    </header>

    <main class="main">
      <!-- Category badges -->
      <div class="category-badge debug">Debug Suite</div>
      <div class="category-badge core">Core Development</div>
      <div class="category-badge review">Review</div>

      <svg id="visualization"></svg>

      <div class="controls">
        <button class="btn" id="animateBtn" aria-label="Play workflow animation">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="5 3 19 12 5 21 5 3"/>
          </svg>
          Play Workflow
        </button>
        <button class="btn" id="resetBtn" aria-label="Reset visualization">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
            <path d="M3 3v5h5"/>
          </svg>
          Reset
        </button>
      </div>

      <!-- Progress indicator for animation -->
      <div class="progress-indicator" id="progress">
        <div class="progress-dot" data-step="0"></div>
        <div class="progress-dot" data-step="1"></div>
        <div class="progress-dot" data-step="2"></div>
        <div class="progress-dot" data-step="3"></div>
        <div class="progress-dot" data-step="4"></div>
        <div class="progress-dot" data-step="5"></div>
        <div class="progress-dot" data-step="6"></div>
        <div class="progress-dot" data-step="7"></div>
        <div class="progress-dot" data-step="8"></div>
        <div class="progress-dot" data-step="9"></div>
        <span class="progress-label">Workflow Progress</span>
      </div>
    </main>

    <aside class="sidebar">
      <div class="sidebar-tabs" role="tablist">
        <button class="tab active" data-tab="detail" role="tab" aria-selected="true">Details</button>
        <button class="tab" data-tab="legend" role="tab" aria-selected="false">All Agents</button>
        <button class="tab" data-tab="start" role="tab" aria-selected="false">Get Started</button>
      </div>

      <div class="sidebar-content">
        <!-- Detail Panel - Now with welcome state -->
        <div class="panel active" id="detail-panel" role="tabpanel">
          <div class="welcome">
            <div class="welcome-icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="3"/>
                <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4"/>
              </svg>
            </div>
            <h3>Welcome to AgentFlow</h3>
            <p>21 specialized AI agents to help you build software products. Click any node to explore, or try these quick actions:</p>
            <div class="quick-actions">
              <button class="quick-action" onclick="window.selectAgent(0)" tabindex="0">
                <div class="quick-action-icon blue">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"/>
                  </svg>
                </div>
                <div class="quick-action-text">
                  <strong>Start with Orchestrator</strong>
                  <span>Agent 0 guides your next step</span>
                </div>
              </button>
              <button class="quick-action" onclick="document.getElementById('animateBtn').click()" tabindex="0">
                <div class="quick-action-icon orange">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                  </svg>
                </div>
                <div class="quick-action-text">
                  <strong>Watch the Workflow</strong>
                  <span>See how agents work together</span>
                </div>
              </button>
              <button class="quick-action" onclick="document.querySelector('[data-tab=start]').click()" tabindex="0">
                <div class="quick-action-icon green">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                    <polyline points="14 2 14 8 20 8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                  </svg>
                </div>
                <div class="quick-action-text">
                  <strong>Get Started Guide</strong>
                  <span>Copy-paste prompts to begin</span>
                </div>
              </button>
            </div>
          </div>
        </div>

        <!-- Legend Panel -->
        <div class="panel" id="legend-panel" role="tabpanel">
          <div class="legend-section">
            <div class="legend-title">
              <span class="legend-dot core"></span>
              Core Development (0-9)
            </div>
            <div class="legend-list" id="core-list" role="listbox"></div>
          </div>
          <div class="legend-section">
            <div class="legend-title">
              <span class="legend-dot debug"></span>
              Debug Suite (10-16)
            </div>
            <div class="legend-list" id="debug-list" role="listbox"></div>
          </div>
          <div class="legend-section">
            <div class="legend-title">
              <span class="legend-dot review"></span>
              Review & Specialized (17-20)
            </div>
            <div class="legend-list" id="review-list" role="listbox"></div>
          </div>
        </div>

        <!-- Get Started Panel -->
        <div class="panel" id="start-panel" role="tabpanel">
          <div class="step">
            <div class="step-header">
              <span class="step-num">1</span>
              <h3>Copy the Orchestrator Prompt</h3>
            </div>
            <p>Start with Agent 0 to get guidance on your next steps.</p>
            <div class="code-block">
              <button class="copy-btn" onclick="copyText(this)">Copy</button>
cat agents/agent-0-orchestrator.md</div>
          </div>

          <div class="step">
            <div class="step-header">
              <span class="step-num">2</span>
              <h3>Describe Your Project</h3>
            </div>
            <p>Paste into Claude and add your context:</p>
            <div class="code-block">
              <button class="copy-btn" onclick="copyText(this)">Copy</button>
I want to build [YOUR IDEA].

Target users: [WHO]
Problem: [WHAT]

Constraints:
- Timeline: [X weeks]
- Budget: [$X/month]
- Tech: [preferences]

What should I do first?</div>
          </div>

          <div class="step">
            <div class="step-header">
              <span class="step-num">3</span>
              <h3>Follow the Flow</h3>
            </div>
            <p>Agent 0 will guide you through the development process:</p>
            <div class="code-block">
              <button class="copy-btn" onclick="copyText(this)">Copy</button>
0 → Orchestrator (start here)
1 → Problem Brief
2 → Competitive Analysis
3 → PRD (requirements)
4 → UX Flows
5 → Architecture
6 → Code
7 → Tests
8 → Deployment
9 → Analytics</div>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // Agent data with full names
    const agents = [
      { id: 0, name: "Orchestrator", category: "core", description: "Project director that assesses your current state and recommends the next best action. Start here when beginning a new project or feeling stuck.", useCases: ["Starting a new project", "Feeling stuck or unsure", "Need status assessment"], output: "Status summary + next actions" },
      { id: 1, name: "Problem Framer", category: "core", description: "Clarifies vague ideas into concrete problem statements. Identifies target users, their jobs-to-be-done, and success criteria.", useCases: ["Have a vague idea", "Need to define users", "Clarifying the problem"], output: "artifacts/problem-brief-v0.1.md" },
      { id: 2, name: "Competitive Mapper", category: "core", description: "Analyzes the competitive landscape to find your strategic wedge. Maps direct and indirect competitors.", useCases: ["Understanding competition", "Finding differentiation", "Market positioning"], output: "artifacts/competitive-analysis-v0.1.md" },
      { id: 3, name: "Product Manager", category: "core", description: "Writes focused PRDs with strict scope control. Limits to 5-8 MUST features with clear acceptance criteria.", useCases: ["Scoping v0.1 features", "Writing requirements", "Feature prioritization"], output: "artifacts/prd-v0.1.md" },
      { id: 4, name: "UX Designer", category: "core", description: "Designs user flows, wireframes, and interaction patterns that balance user needs with feasibility.", useCases: ["User journeys", "Wireframes", "UI interactions"], output: "artifacts/ux-flows-v0.1.md" },
      { id: 5, name: "System Architect", category: "core", description: "Chooses tech stack with boring-tech-first philosophy. Recommends monoliths over microservices.", useCases: ["Tech stack decisions", "System architecture", "Infrastructure choices"], output: "artifacts/architecture-v0.1.md" },
      { id: 6, name: "Engineer", category: "core", description: "Implements features with thin-slice methodology. Includes security awareness and error handling.", useCases: ["Production code", "Feature implementation", "Secure coding"], output: "Code in src/" },
      { id: 7, name: "QA Engineer", category: "core", description: "Creates comprehensive testing strategies covering unit, integration, and E2E tests.", useCases: ["Test plans", "Test suites", "QA review"], output: "artifacts/test-plan-v0.1.md" },
      { id: 8, name: "DevOps", category: "core", description: "Sets up deployment pipelines with one-command-deploy philosophy.", useCases: ["CI/CD setup", "Infrastructure", "Deployment"], output: "artifacts/deployment-plan-v0.1.md" },
      { id: 9, name: "Analytics", category: "core", description: "Instruments analytics with focused event tracking. Identifies the 5-10 metrics that matter.", useCases: ["Analytics setup", "Success metrics", "Growth tracking"], output: "artifacts/analytics-plan-v0.1.md" },

      { id: 10, name: "Debug Detective", category: "debug", description: "Triage specialist that analyzes bugs and routes to the appropriate debug specialist.", useCases: ["Bug triage", "Debug routing", "Issue diagnosis"], output: "Debug routing recommendation" },
      { id: 11, name: "Visual Debugger", category: "debug", description: "Specializes in CSS, layout, and visual rendering issues.", useCases: ["CSS issues", "Layout bugs", "Visual rendering"], output: "Visual bug fixes" },
      { id: 12, name: "Performance Profiler", category: "debug", description: "Identifies performance bottlenecks through profiling analysis.", useCases: ["Slow loads", "Bottlenecks", "Optimization"], output: "Performance fixes" },
      { id: 13, name: "Network Inspector", category: "debug", description: "Debugs API failures, network errors, and CORS issues.", useCases: ["API failures", "Network errors", "CORS"], output: "Network fixes" },
      { id: 14, name: "State Debugger", category: "debug", description: "Diagnoses Redux, Context, and state management bugs.", useCases: ["State bugs", "Data flow", "Sync issues"], output: "State fixes" },
      { id: 15, name: "Error Tracker", category: "debug", description: "Analyzes runtime errors and stack traces to find root causes.", useCases: ["Runtime errors", "Exceptions", "Stack traces"], output: "Error fixes" },
      { id: 16, name: "Memory Hunter", category: "debug", description: "Detects memory leaks and resource management problems.", useCases: ["Memory leaks", "Resource cleanup", "Performance decay"], output: "Memory fixes" },

      { id: 17, name: "Security Auditor", category: "review", description: "Conducts security reviews focusing on OWASP Top 10 and authorization issues.", useCases: ["Security review", "PR checks", "Vulnerability scan"], output: "Security findings" },
      { id: 18, name: "Code Reviewer", category: "review", description: "Reviews code for quality, maintainability, and best practices.", useCases: ["PR reviews", "Code quality", "Best practices"], output: "Review comments" },
      { id: 19, name: "Database Engineer", category: "review", description: "Handles migrations, query optimization, and schema design with safeguards.", useCases: ["Migrations", "Query optimization", "Schema design"], output: "Database changes" },
      { id: 20, name: "Design Reviewer", category: "review", description: "Reviews design system consistency, accessibility, and UX patterns.", useCases: ["Design audit", "Accessibility", "UX consistency"], output: "Design review" }
    ];

    // Connections for workflow
    const connections = [
      {source: 0, target: 1}, {source: 1, target: 2}, {source: 2, target: 3},
      {source: 3, target: 4}, {source: 4, target: 5}, {source: 5, target: 6},
      {source: 6, target: 7}, {source: 7, target: 8}, {source: 8, target: 9},
      {source: 10, target: 11}, {source: 10, target: 12}, {source: 10, target: 13},
      {source: 10, target: 14}, {source: 10, target: 15}, {source: 10, target: 16},
      {source: 6, target: 17}, {source: 6, target: 18}, {source: 5, target: 19}, {source: 4, target: 20}
    ];

    const colors = {
      core: { main: '#3b82f6', light: '#dbeafe', glow: 'rgba(59, 130, 246, 0.4)' },
      debug: { main: '#f97316', light: '#ffedd5', glow: 'rgba(249, 115, 22, 0.4)' },
      review: { main: '#22c55e', light: '#dcfce7', glow: 'rgba(34, 197, 94, 0.4)' }
    };

    // Setup
    const svg = d3.select('#visualization');
    const container = document.querySelector('.main');
    let width = container.clientWidth;
    let height = container.clientHeight;
    let selectedAgent = null;

    svg.attr('width', width).attr('height', height);

    const linksGroup = svg.append('g').attr('class', 'links');
    const flowGroup = svg.append('g').attr('class', 'flow');
    const nodesGroup = svg.append('g').attr('class', 'nodes');

    // Calculate positions with better spacing
    function calculatePositions() {
      const cx = width * 0.5;
      const cy = height * 0.52;
      const coreRadius = Math.min(width, height) * 0.32;

      // Core agents in circle (centered)
      agents.filter(a => a.category === 'core').forEach((agent, i) => {
        const angle = (i / 10) * 2 * Math.PI - Math.PI / 2;
        agent.x = cx + Math.cos(angle) * coreRadius;
        agent.y = cy + Math.sin(angle) * coreRadius;
      });

      // Debug agents - left side, better organized
      const debugStartX = 100;
      const debugStartY = height * 0.22;
      const debugSpacingY = 70;

      // Detective at top center
      agents[10].x = debugStartX + 50;
      agents[10].y = debugStartY;

      // Rest in 2 columns with more spacing
      const debugCols = [
        { x: debugStartX, y: debugStartY + debugSpacingY },
        { x: debugStartX + 100, y: debugStartY + debugSpacingY },
        { x: debugStartX, y: debugStartY + debugSpacingY * 2 },
        { x: debugStartX + 100, y: debugStartY + debugSpacingY * 2 },
        { x: debugStartX, y: debugStartY + debugSpacingY * 3 },
        { x: debugStartX + 100, y: debugStartY + debugSpacingY * 3 }
      ];

      for (let i = 11; i <= 16; i++) {
        agents[i].x = debugCols[i - 11].x;
        agents[i].y = debugCols[i - 11].y;
      }

      // Review agents - right side in column
      const reviewX = width - 110;
      const reviewStartY = height * 0.22;
      const reviewSpacingY = 85;

      for (let i = 17; i <= 20; i++) {
        agents[i].x = reviewX;
        agents[i].y = reviewStartY + (i - 17) * reviewSpacingY;
      }
    }

    calculatePositions();

    // Draw workflow flow path (the main 0-9 path)
    function drawFlowPath() {
      flowGroup.selectAll('*').remove();

      const corePath = agents.slice(0, 10);
      const pathData = d3.line()
        .x(d => d.x)
        .y(d => d.y)
        .curve(d3.curveCardinal.tension(0.7));

      flowGroup.append('path')
        .attr('class', 'workflow-path')
        .attr('id', 'workflow-flow')
        .attr('d', pathData(corePath));
    }

    // Draw links
    function drawLinks() {
      linksGroup.selectAll('*').remove();

      connections.forEach(conn => {
        const source = agents[conn.source];
        const target = agents[conn.target];

        linksGroup.append('line')
          .attr('class', 'link-line')
          .attr('x1', source.x)
          .attr('y1', source.y)
          .attr('x2', target.x)
          .attr('y2', target.y);
      });
    }

    // Draw nodes
    function drawNodes() {
      nodesGroup.selectAll('*').remove();

      const groups = nodesGroup.selectAll('.node-group')
        .data(agents)
        .enter()
        .append('g')
        .attr('class', d => `node-group ${d.id === selectedAgent ? 'selected' : ''}`)
        .attr('transform', d => `translate(${d.x}, ${d.y})`)
        .attr('tabindex', '0')
        .attr('role', 'button')
        .attr('aria-label', d => `Agent ${d.id}: ${d.name}`)
        .on('click', (e, d) => showAgent(d))
        .on('keydown', (e, d) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            showAgent(d);
          }
        });

      // Glow effect for selected
      groups.append('circle')
        .attr('class', 'node-glow')
        .attr('r', 32)
        .attr('fill', d => colors[d.category].glow)
        .attr('opacity', 0);

      // Main circle
      groups.append('circle')
        .attr('class', 'node-bg')
        .attr('r', 22)
        .attr('fill', d => colors[d.category].main);

      // Number
      groups.append('text')
        .attr('class', 'node-label')
        .attr('font-size', '13px')
        .text(d => d.id);

      // Name below - now with full name using two lines if needed
      groups.each(function(d) {
        const g = d3.select(this);
        const name = d.name;

        if (name.length <= 12) {
          g.append('text')
            .attr('class', 'node-name')
            .attr('y', 38)
            .text(name);
        } else {
          // Split into two lines
          const words = name.split(' ');
          if (words.length >= 2) {
            g.append('text')
              .attr('class', 'node-name')
              .attr('y', 36)
              .text(words[0]);
            g.append('text')
              .attr('class', 'node-name')
              .attr('y', 48)
              .text(words.slice(1).join(' '));
          } else {
            g.append('text')
              .attr('class', 'node-name')
              .attr('y', 38)
              .text(name.slice(0, 12) + '…');
          }
        }
      });
    }

    drawFlowPath();
    drawLinks();
    drawNodes();

    // Show agent details
    function showAgent(agent) {
      selectedAgent = agent.id;

      // Update node selection visual
      nodesGroup.selectAll('.node-group')
        .classed('selected', d => d.id === agent.id);
      nodesGroup.selectAll('.node-glow')
        .attr('opacity', d => d.id === agent.id ? 0.6 : 0);

      // Update legend selection
      document.querySelectorAll('.legend-item').forEach(item => {
        item.classList.toggle('selected', parseInt(item.dataset.id) === agent.id);
      });

      const panel = document.getElementById('detail-panel');
      const prevId = agent.id > 0 ? agent.id - 1 : null;
      const nextId = agent.id < 20 ? agent.id + 1 : null;

      panel.innerHTML = `
        <div class="agent-header">
          <div class="agent-badge ${agent.category}">${agent.id}</div>
          <div class="agent-info">
            <h2>${agent.name}</h2>
            <span class="agent-tag ${agent.category}">${agent.category === 'core' ? 'Core Development' : agent.category === 'debug' ? 'Debug Suite' : 'Review'}</span>
          </div>
        </div>
        <div class="section">
          <div class="section-title">Description</div>
          <p>${agent.description}</p>
        </div>
        <div class="section">
          <div class="section-title">When to Use</div>
          <div class="use-case-list">
            ${agent.useCases.map(u => `<div class="use-case ${agent.category}">${u}</div>`).join('')}
          </div>
        </div>
        <div class="section">
          <div class="section-title">Output</div>
          <span class="output-code">${agent.output}</span>
        </div>
        <div class="nav-hint">
          <button class="nav-btn" ${prevId === null ? 'disabled' : ''} onclick="window.selectAgent(${prevId})">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6"/>
            </svg>
            Previous
          </button>
          <button class="nav-btn" ${nextId === null ? 'disabled' : ''} onclick="window.selectAgent(${nextId})">
            Next
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6"/>
            </svg>
          </button>
        </div>
      `;

      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelector('[data-tab="detail"]').classList.add('active');
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      panel.classList.add('active');
    }

    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => {
          t.classList.remove('active');
          t.setAttribute('aria-selected', 'false');
        });
        tab.classList.add('active');
        tab.setAttribute('aria-selected', 'true');
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        document.getElementById(`${tab.dataset.tab}-panel`).classList.add('active');
      });
    });

    // Populate legend with data attributes for selection
    ['core', 'debug', 'review'].forEach(cat => {
      const list = document.getElementById(`${cat}-list`);
      list.innerHTML = agents
        .filter(a => a.category === cat)
        .map(a => `
          <div class="legend-item" data-id="${a.id}" onclick="window.selectAgent(${a.id})" tabindex="0" role="option"
               onkeydown="if(event.key==='Enter')window.selectAgent(${a.id})">
            <span class="legend-num ${cat}">${a.id}</span>
            <span class="legend-name">${a.name}</span>
          </div>
        `).join('');
    });

    window.selectAgent = id => showAgent(agents[id]);

    // Animation with progress indicator
    let animating = false;
    const progressEl = document.getElementById('progress');
    const progressDots = progressEl.querySelectorAll('.progress-dot');

    document.getElementById('animateBtn').addEventListener('click', function() {
      if (animating) return;
      animating = true;
      this.classList.add('active');
      progressEl.classList.add('visible');

      // Activate flow path animation
      const flowPath = document.getElementById('workflow-flow');
      flowPath.classList.add('active');

      const path = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
      let step = 0;

      // Reset progress dots
      progressDots.forEach(dot => {
        dot.classList.remove('active', 'done');
      });

      const animate = () => {
        if (step >= path.length) {
          animating = false;
          document.getElementById('animateBtn').classList.remove('active');
          setTimeout(() => {
            progressEl.classList.remove('visible');
            flowPath.classList.remove('active');
          }, 2000);
          return;
        }

        // Update progress
        progressDots.forEach((dot, i) => {
          dot.classList.remove('active');
          if (i < step) dot.classList.add('done');
          if (i === step) dot.classList.add('active');
        });

        const agent = agents[path[step]];
        showAgent(agent);

        // Pulse effect
        nodesGroup.selectAll('.node-group')
          .filter(d => d.id === path[step])
          .select('.node-bg')
          .transition().duration(150).attr('r', 28)
          .transition().duration(250).attr('r', 22);

        // Glow effect
        nodesGroup.selectAll('.node-group')
          .filter(d => d.id === path[step])
          .select('.node-glow')
          .transition().duration(150).attr('opacity', 0.8)
          .transition().duration(400).attr('opacity', 0.3);

        step++;
        setTimeout(animate, 700);
      };

      animate();
    });

    // Reset
    document.getElementById('resetBtn').addEventListener('click', () => {
      selectedAgent = null;
      calculatePositions();
      drawFlowPath();
      drawLinks();
      drawNodes();

      // Reset to welcome state
      const panel = document.getElementById('detail-panel');
      panel.innerHTML = `
        <div class="welcome">
          <div class="welcome-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4"/>
            </svg>
          </div>
          <h3>Welcome to AgentFlow</h3>
          <p>21 specialized AI agents to help you build software products. Click any node to explore, or try these quick actions:</p>
          <div class="quick-actions">
            <button class="quick-action" onclick="window.selectAgent(0)" tabindex="0">
              <div class="quick-action-icon blue">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
              </div>
              <div class="quick-action-text">
                <strong>Start with Orchestrator</strong>
                <span>Agent 0 guides your next step</span>
              </div>
            </button>
            <button class="quick-action" onclick="document.getElementById('animateBtn').click()" tabindex="0">
              <div class="quick-action-icon orange">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                  <polyline points="22 4 12 14.01 9 11.01"/>
                </svg>
              </div>
              <div class="quick-action-text">
                <strong>Watch the Workflow</strong>
                <span>See how agents work together</span>
              </div>
            </button>
            <button class="quick-action" onclick="document.querySelector('[data-tab=start]').click()" tabindex="0">
              <div class="quick-action-icon green">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                  <polyline points="14 2 14 8 20 8"/>
                  <line x1="16" y1="13" x2="8" y2="13"/>
                  <line x1="16" y1="17" x2="8" y2="17"/>
                </svg>
              </div>
              <div class="quick-action-text">
                <strong>Get Started Guide</strong>
                <span>Copy-paste prompts to begin</span>
              </div>
            </button>
          </div>
        </div>
      `;

      document.querySelectorAll('.legend-item').forEach(item => {
        item.classList.remove('selected');
      });
    });

    // Copy helper
    window.copyText = btn => {
      const code = btn.parentElement.textContent.replace('Copy', '').trim();
      navigator.clipboard.writeText(code);
      btn.textContent = 'Copied!';
      setTimeout(() => btn.textContent = 'Copy', 1500);
    };

    // Resize handler
    window.addEventListener('resize', () => {
      width = container.clientWidth;
      height = container.clientHeight;
      svg.attr('width', width).attr('height', height);
      calculatePositions();
      drawFlowPath();
      drawLinks();
      drawNodes();
    });

    // Keyboard navigation for nodes
    document.addEventListener('keydown', (e) => {
      if (selectedAgent !== null && (e.key === 'ArrowLeft' || e.key === 'ArrowRight')) {
        e.preventDefault();
        const newId = e.key === 'ArrowLeft'
          ? Math.max(0, selectedAgent - 1)
          : Math.min(20, selectedAgent + 1);
        showAgent(agents[newId]);
      }
    });
  </script>
</body>
</html>
